- device: Launch Control
  controls:
    1:
      type: midi_note
      input: Launch Control
      channel: 2
      note: 9
    2:
      type: midi_note
      input: Launch Control
      channel: 2
      note: 10
    3:
      type: midi_note
      input: Launch Control
      channel: 2
      note: 11
    8:
      type: midi_note
      input: Launch Control
      channel: 2
      note: 28

    1000:
      type: midi_channel
      input: Launch Control
      channel: 2

- page: main
  active: true
  widgets:
    - button: tempo_reset

    - button: shift_inc
      device: Launch Control
      device_control: 1

    - button: tempo_dec
      device: Launch Control
      device_control: 2

    - button: tempo_inc
      device: Launch Control
      device_control: 3

    - button: shift_tempo_shuffle
      device: Launch Control
      device_control: 8

- page: shuffle
  active: false
  widgets:
    - button: shuffle_dec
      device: Launch Control
      device_control: 2

    - button: shuffle_inc
      device: Launch Control
      device_control: 3

    - button: shuffle_reset

- var: inc
  value: 1

- pipeline:
  pipe:
    - map: bool(shift_tempo_shuffle.value)
      vars:
        shift_tempo_shuffle.value: rx
    - out: shuffle.active

- pipeline:
  pipe:
    - map: shift_inc.value * 9 + 1
      vars:
        shift_inc.value: rx
    - out: inc.value

- pipeline:
  pipe:
    - filter: shuffle_dec.value > 0
      vars:
        shuffle_dec.value: rx
    - map: >
        clock.shuffle + inc.value * (
          input[0] * (-1)
        )
      vars:
        clock.shuffle: static
        inc.value: static
        input: rx
    - out: clock.shuffle

- pipeline:
  pipe:
    - filter: shuffle_inc.value > 0
      vars:
        shuffle_inc.value: rx
    - map: >
        clock.shuffle + inc.value * (
          input[0] * (+1)
        )
      vars:
        clock.shuffle: static
        inc.value: static
        input: rx
    - out: clock.shuffle

- pipeline:
  pipe:
    - filter: tempo_dec.value > 0
      vars:
        tempo_dec.value: rx
    - map: clock.tempo - inc.value * input[0]
      vars:
        input: rx
        clock.tempo: static
        inc.value: static
    - map: input * 1.0000
      vars:
        input: rx
    - out: clock.tempo

- pipeline:
  pipe:
    - filter: tempo_inc.value > 0
      vars:
        tempo_inc.value: rx
    - map: clock.tempo + inc.value * input[0]
      vars:
        input: rx
        clock.tempo: static
        inc.value: static
    - out: clock.tempo

- clock: clock
  tempo: 120
  shuffle: 50
