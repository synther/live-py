- page: main
  active: true
  widgets:
    - button: shift_shuffle
    - button: tempo_dec
      hw: LaunchPad1
      hw_pos: 1
    - button: tempo_inc
      hw: LaunchPad1
      hw_pos: 2
    - button: shift_inc
      hw: LaunchPad1
      hw_pos: 3
    - button: tempo_reset

- page: shuffle
  active: false
  widgets:
    - button: shuffle_dec
      hw: LaunchPad1
      hw_pos: 1
    - button: shuffle_inc
      hw: LaunchPad1
      hw_pos: 2
    - button: shuffle_reset

- var: inc

- pipeline:
  pipe:
    - map: shift_inc.value * 9 + 1
      vars:
        shift_inc.value: rx
    - out: inc.value

- pipeline:
  pipe:
    - filter: tempo_dec.value > 0
      vars:
        tempo_dec.value: rx
    - map: clock.tempo - inc.value * input[0]
      vars:
        input: rx
        clock.tempo: static
        inc.value: static
    - map: input * 1.00001
      vars:
        input: rx
    - out: clock.tempo

- pipeline:
  pipe:
    - filter: tempo_inc.value > 0
      vars:
        tempo_inc.value: rx
    - map: clock.tempo + inc.value * input[0]
      vars:
        input: rx
        clock.tempo: static
        inc.value: static
    - out: clock.tempo

- pipeline:
  pipe:
    - one_shot: 120
    - out: clock.tempo

- pipeline:
  pipe:
    - one_shot: 1
    - out: inc.value

- clock: clock
  tempo: 120
  shuffle: 50
